{"createdAt":"2025-04-15T02:24:00.680Z","updatedAt":"2025-04-15T02:31:43.000Z","id":"n0dBW5M4z4NyPydm","name":"My workflow 5","active":false,"nodes":[{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[0,0],"id":"15080a41-33c1-4e56-9de3-86189e226c78","name":"When chat message received","webhookId":"afce3fec-0ff2-430b-a7ae-61bd0cd8abbc"},{"parameters":{"options":{"systemMessage":"=## Vai trò:\n- Bạn tên là Cherry\n- Bạn là một chuyên gia về phân tích dữ liệu, đặc biệt am hiểu về cấu trức SQL\n\n## Công cụ:\n- `BigQuery`: Dùng để truy vấn SQL trích xuất dữ liệu trên nền tảng BigQuery của Google\n- `Calculator`: dùng để tính toán các phép tính đơn giản cần độ chính xác cao như %\n\n## Hướng dẫn: \n- Chào người dùng và giới thiệu mình là ai, có khả năng gì. Sau đó hỏi người dùng cần phân tích dữ liệu gì\n- Tiếp nhận thông tin yêu cầu của người dùng và tiến hành phân tích:\n1. Trường hợp 1: thông tin chưa đủ sẽ hỏi lại và nhờ người dùng cung cấp thêm\n2. Trường hợp 2: thông tin đầy đủ thì dùng `Tool` để truy vấn dữ liệu trong database và trả lời người dùng\n\nCấu trúc cảu bảng dữ liệu như sau:\n\n**Table ID**: `sinifood.sale_revenue.sale_revenue_032025`\n\nDanh sách các cột \n\n- transaction_id\tString\tMã giao dịch, định danh duy nhất cho mỗi giao dịch.\n- branch\tString\tTên chi nhánh nơi giao dịch diễn ra.\n- time_per_transaction\tDateTime\tThời gian thực hiện giao dịch.\n- total_product_value_per_transaction\tNumeric (Currency)\tTổng giá trị sản phẩm trong giao dịch.\n- discount_per_transaction\tNumeric (Currency)\tTổng giá trị giảm giá trong giao dịch.\n- revenue_per_transaction\tNumeric (Currency)\tDoanh thu thu được từ giao dịch.\n- total_cost_per_transaction\tNumeric (Currency)\tTổng chi phí liên quan đến giao dịch.\n- gross_profit_per_transaction\tNumeric (Currency)\tLợi nhuận gộp từ giao dịch.\n- product_code\tString\tMã sản phẩm, định danh duy nhất cho mỗi sản phẩm.\n- product_name\tString\tTên sản phẩm.\n- brand\tString\tThương hiệu của sản phẩm (có thể để trống).\n- product_category_3_levels\tString\tDanh mục sản phẩm theo 3 cấp độ (có thể để trống).\n- quantity\tNumeric\tSố lượng sản phẩm được bán trong giao dịch.\n- selling_price_per_unit\tNumeric (Currency)\tGiá bán mỗi đơn vị sản phẩm.\n- cost_per_unit\tNumeric (Currency)\tChi phí mỗi đơn vị sản phẩm.\n- profit_per_unit\tNumeric (Currency)\tLợi nhuận mỗi đơn vị sản phẩm.\n- total_product_profit\tNumeric (Currency)\tTổng lợi nhuận từ sản phẩm trong giao dịch.\n\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[220,0],"id":"08df86ca-0c3c-4d91-b9ba-f793fc24667f","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4o-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[100,220],"id":"f7fcd0e0-5366-42b2-9060-46967d84d933","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"YUXfwQd3CGq9bfen","name":"OpenAi account"}}},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","typeVersion":1.3,"position":[340,240],"id":"93f95c98-31e8-4a20-b398-4ed73b4f601c","name":"Simple Memory"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolCalculator","typeVersion":1,"position":[680,220],"id":"8e98f0c0-8f62-4596-ae56-2998c9f11e56","name":"Calculator"},{"parameters":{"projectId":{"__rl":true,"value":"sinifood","mode":"list","cachedResultName":"sinifood","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=sinifood"},"sqlQuery":"{{ $fromAI(\"sql\", \"Thông tin sql để truy vấn nhằm phản hồi yêu cầu của người dùng\") }}","options":{}},"type":"n8n-nodes-base.googleBigQueryTool","typeVersion":2.1,"position":[500,220],"id":"e08b4233-2e43-455a-bc35-26176a5677b9","name":"BigQuery","credentials":{"googleBigQueryOAuth2Api":{"id":"m6cuKhEidHJucQSW","name":"Google BigQuery account"}}}],"connections":{"When chat message received":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Simple Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Calculator":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"BigQuery":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"c8bc3e29-39b1-46f6-aed9-c02c7b2e17cb","triggerCount":0,"tags":[]}